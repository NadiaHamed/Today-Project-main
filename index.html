<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
        <meta name="description" content="" />
        <meta name="author" content="" />
        <title>Hello Project#2</title>
        <!-- Favicon-->
        <link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
        <!-- Core theme CSS (includes Bootstrap)-->
        <link href="css/styles.css" rel="stylesheet" />
       <!--  <link href="css/new.css" rel="stylesheet" />
        <link
        rel="stylesheet"
        href="https://stackpath.bootstrapcdn.com/bootstrap/4.4.1/css/bootstrap.min.css"
        integrity="sha384-Vkoo8x4CGsO3+Hhxv8T/Q5PaXtkKtu6ug5TOeNV6gBiFeWPGFN9MuhOf23Q9Ifjh"
        crossorigin="anonymous"
      />-->
   
		<script src="news.js"></script>
		<!--<link rel="stylesheet" href="style.css" />-->
		 
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
 
    <!-- The form -->
   
	</head>
	<body>
		<!-- Here a loader is created which
			loads till response comes -->
            <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
                <div class="container px-5">
                    <a class="navbar-brand" href="#!">Welcome</a>
                    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation"><span class="navbar-toggler-icon"></span></button>
                    <div class="collapse navbar-collapse" id="navbarSupportedContent">
                        <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                            <li class="nav-item"><a class="nav-link active" aria-current="page" href="#!">Home</a></li>
                            <li class="nav-item"><a class="nav-link" href="#!">About</a></li>
                            <li class="nav-item"><a class="nav-link" href="#!">Contact</a></li>
                            <li class="nav-item"><a class="nav-link" href="#!">Services</a></li>
                        </ul>
                    </div>
                </div>
            </nav>
            <div class="row gx-4 gx-lg-5 align-items-md-baseline my-5">
               
                
                <div class="col-lg-7" style="width:500px; margin:0 auto; "> 
                     <div class="card">
                         <div class="container">
                             <h1 class="text-center title">Weather in</h1>
                             <div class="text-center">   <button onClick="window.location.reload();" class="refresh"><i class="fa fa-refresh"></i></button></div>
                             
                             <label for="search"> 
                              <div class="text-center"> 
                              <label for="search"> <div class="search" >
                                <input
                                type="text"
                                class="searchTerm
                                name="city"
                                placeholder="What city?"
                                autocomplete="off"
                                id="ho"
                             />     <button type="submit" class="searchButton" onclick="key2();return false;">
                                  <i class="fa fa-search"></i>
                               </button>
                             </div></label></label></div>
                             <div class="text-center"> 
                             <img src="img/day_image.svg" alt="" class="card-img-top time" id="day" />
       
                             <h2><i class="fa fa-map-marker"></i> <span id="location"></span></h2>
                             <h6 id="weather">  </h6><img id="icon" src="">
                             <h4><span id="temp"></span><sup>o</sup>C</h4>
                             
                             <h4><span id="humidity"></sup> </h4>
                               
                            </div>
                            
                            
                            </div>
                              
                 </div></div></div></div> 
		<div class="d-flex justify-content-center">
			<div class="spinner-border"
				role="status" id="loading">
				<span class="sr-only">Loading...</span>
			</div>
		</div>
 
      
     

       
 
        <div class="card text-dark bg-light my-5 py-4 text-center">
       
             <label for="search"> 
                
                <label for="search"> <div class="search">
                  <input type="text" class="searchTerm" id="search" placeholder="Search for News">
                  <button type="submit" class="searchButton" onclick="searchnews();return false;">
                    <i class="fa fa-search"></i>
                 </button>
               </div></label>
               
                <br>
                   <button class="button button4" onclick="category('business'); "> business</button><button class="button button4" onclick="category('entertainment');return false; ">entertainment</button><button class="button button4"onclick="category('general'); " > general</button><button class="button button4" onclick="category('health'); ">health</button>
                 <button class="button button4" onclick="category('science'); "> science</button> <button class="button button4" onclick="category('sports');return false; "> sports</button><button class="button button4" onclick="category('technology'); ">technology</button>   </div>
                </label> 
        
		<!-- table for showing data -->
    <div class="container mt-5 mb-5">
		<div class="container mt-5 mb-5" id="hi">
                        
     
		</div>
    
    <button class="button button2"onclick='pageprev();return false;'> << Previous</button>
		  <button class="button button2"onclick='pagenext();return false;' > Next >></button>
    </div>
 
		<table id="employees"></table>
        <script type="text/javascript">
         
 
 
          const spitOutCelcius = (kelvin) => {
    celcius = Math.round(kelvin - 273.15);
    return celcius;
}
            //const url = `https://api.openweathermap.org/data/2.5/weather?q=${inputVal}&appid=${apiKey}&units=metric`;
          function key2(){
            
            let inputVal = document.getElementById('ho').value;
          if( document.getElementById('ho').value==null){
            inputVal=s
          
          
          }
          
          //  let inputVal = "london";
          link = `https://api.openweathermap.org/data/2.5/weather?q=${inputVal}&appid=bf8d15a80c89aa4f4c82ad6cbb3f5ac5`;
          var request = new XMLHttpRequest();
          request.open('GET',link,true);
          request.onload = function(){
           var obj = JSON.parse(this.response);
           console.log(obj);
           
           document.getElementById('weather').innerHTML = obj.weather[0].description;
           document.getElementById('location').innerHTML = obj.name;
           document.getElementById('temp').innerHTML =spitOutCelcius(obj.main.temp);
          // obj.main.temp_max - 273.15;
         
           document.getElementById('icon').src = "http://openweathermap.org/img/w/" + obj.weather[0].icon + ".png";
           if (obj.weather[0].icon.includes('d')) {
        document.getElementById("day").src="img/day_image.svg"; }
      else {  document.getElementById("day").src="img/night_image.svg";}

    
           if (request.status >= 200 && request.status < 400) {
           var temp = obj.main.temp;
           }
           else{
            console.log("The city doesn't exist! Kindly check");
           }
          }
          request.send();
          
          }
        //-----------------------------------------------------  
         
        //-----------------------------------------------------    
          var lat;
          var long;
          navigator.geolocation.getCurrentPosition(function(position) {
              let lat = position.coords.latitude;
              let long = position.coords.longitude;
           
              link = `https://api.openweathermap.org/data/2.5/weather?lat=${lat}&lon=${long}&appid=bf8d15a80c89aa4f4c82ad6cbb3f5ac5`;
           var request = new XMLHttpRequest();
          request.open('GET',link,true);
          request.onload = function(){
           var obj = JSON.parse(this.response);
           console.log(obj);
           
           document.getElementById('weather').innerHTML = obj.weather[0].description;
           document.getElementById('location').innerHTML = obj.name;
           document.getElementById('temp').innerHTML = spitOutCelcius(obj.main.temp);
           document.getElementById('icon').src = "http://openweathermap.org/img/w/" + obj.weather[0].icon + ".png";
         
           if (obj.weather[0].icon.includes('d')) {
        document.getElementById("day").src="img/day_image.svg"; }
      else {  document.getElementById("day").src="img/night_image.svg";}
           if (request.status >= 200 && request.status < 400) {
           var temp = obj.main.temp;
           }
           else{
            console.log("The city doesn't exist! Kindly check");
           }
          }
          request.send();
          
            });
           
           
          //link = `https://api.openweathermap.org/data/2.5/weather?q=${fetchLocationName}&appid=bf8d15a80c89aa4f4c82ad6cbb3f5ac5`;
          
          
          </script>
 
	</body>
</html>
